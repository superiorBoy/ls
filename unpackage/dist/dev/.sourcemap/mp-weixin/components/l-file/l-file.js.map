{"version":3,"sources":["webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?a058","webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?875e","webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?113f","webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?1e4e","uni-app:///components/l-file/l-file.vue","webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?9dca","webpack:///E:/ceshi/lvshi/components/l-file/l-file.vue?8e50"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACqC;;;AAG1F;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAgmB,CAAgB,0nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2BpnB;AACA,gCADA;AAEA;AACA;AACA,kBADA;AAEA,yRAFA,EADA;;AAKA;AACA,kBADA;AAEA,qBAFA,EALA;;AASA;AACA,kBADA;AAEA,wCAFA,EATA;;AAaA;AACA,kBADA;AAEA,wBAFA,EAbA,EAFA;;;AAoBA,MApBA,kBAoBA;AACA;AACA;AACA,mBADA;AAEA,oBAFA;AAGA,cAHA;AAIA,iBAJA;AAKA,kBALA;AAMA,mBANA;AAOA,oBAPA;;AASA,GA/BA;AAgCA;AACA,SADA,mBACA;AACA;AACA,KAHA;AAIA,cAJA,sBAIA,GAJA,EAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAhBA;AAiBA;;;;;;;;AAQA,iBAzBA,2BAyBA;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,KAlDA;AAmDA,gBAnDA,wBAmDA,KAnDA,EAmDA;AACA;AACA,gBADA;AAEA,oBAFA;AAGA;AACA;AACA;AACA,SANA;AAOA,iFAPA;;AASA,KA7DA;AA8DA,gBA9DA,wBA8DA,KA9DA,EA8DA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA,OAJA;AAKA,KAtEA;AAuEA,kBAvEA,4BAuEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAHA,EAGA,IAHA;AAIA,OALA;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA,OANA,EAMA,KANA;;AAQA;AACA;AACA;AACA;AACA;AACA,WAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAfA;AAgBA;AACA;AACA,KAjHA;AAkHA,kBAlHA,4BAkHA;AACA;AACA;AACA;AACA;AACA;AACA,OAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAPA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA,KAzIA;AA0IA,aA1IA,uBA0IA;AACA;AACA,KA5IA;AA6IA,WA7IA,qBA6IA;AACA;AACA;AACA,KAhJA;AAiJA;AACA,cAlJA,sBAkJA,QAlJA,EAkJA;AACA;AACA;AACA;AACA,OAFA,CAEA;AACA;AACA;AACA;AACA,KA1JA;AA2JA;;;AAGA,UA9JA,oBA8JA;AACA;AACA;;;;;;;AAOA;;;;;;AAMA,KA7KA;AA8KA;;;AAGA,QAjLA,gBAiLA,QAjLA,EAiLA;AACA;AACA;AACA;AACA,0BADA;AAEA,+DAFA;;AAIA,KAxLA;AAyLA;;;AAGA,gBA5LA,+BA4LA;AACA;AACA;AACA;AACA;AACA;AACA,uBADA;AAEA,sBAFA;AAGA,2BAHA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA;AACA,SAVA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAPA,EAOA,KAPA;AAQA;AACA,OA9BA;AA+BA,KA7NA;AA8NA;;;;AAIA,YAlOA,2BAkOA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAQA;AACA;AACA;AACA,kBADA;AAEA;AACA;AACA;AACA;AACA,4CADA;AAEA,8IAFA;AAGA,qFAHA;;AAKA,eANA;AAOA;AACA;AACA;AACA;AACA,WAfA;AAgBA,6EAhBA;;;AAmBA;AACA;AACA;AACA;AACA,aAFA;AAGA;AACA,SANA;AAOA,OA5BA;;AA8BA,KA7QA;;AA+QA,YA/QA,oBA+QA,OA/QA,EA+QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAtRA;;AAwRA,YAxRA,sBAwRA;AACA;AACA;AACA;AACA;AACA,KA7RA;;AA+RA,SA/RA,iBA+RA,OA/RA,EA+RA;AACA;AACA,KAjSA;;AAmSA,gBAnSA,wBAmSA,OAnSA,EAmSA,MAnSA,EAmSA;AACA;AACA;AACA;AACA;AACA;AACA,KAzSA,EAhCA,E;;;;;;;;;;;;;AC3BA;AAAA;AAAA;AAAA;AAA04B,CAAgB,24BAAG,EAAC,C;;;;;;;;;;;ACA95B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/l-file/l-file.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./l-file.vue?vue&type=template&id=376a91a4&scoped=true&\"\nvar renderjs\nimport script from \"./l-file.vue?vue&type=script&lang=js&\"\nexport * from \"./l-file.vue?vue&type=script&lang=js&\"\nimport style0 from \"./l-file.vue?vue&type=style&index=0&id=376a91a4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"376a91a4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/l-file/l-file.vue\"\nexport default component.exports","export * from \"-!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./l-file.vue?vue&type=template&id=376a91a4&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./l-file.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./l-file.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class='t-toptips' :style=\"{top: top,background: cubgColor}\" :class=\"[show?'t-top-show':'']\">\r\n\t\t\t<view v-if=\"loading\" class=\"flex flex-sub\">\r\n\t\t\t\t<view class=\"cu-progress flex-sub round striped active sm\">\r\n\t\t\t\t\t<view :style=\"{ background: color,width: value + '%'}\"></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text class=\"margin-left\">{{value}}%</text>\r\n\t\t\t</view>\r\n\t\t\t<block v-else>{{msg}}</block>\r\n\t\t</view>\r\n\t\t<!-- #ifdef H5 -->\r\n\t\t<h5-file \r\n\t\tv-if=\"showH5\"\r\n\t\tref=\"h5File\"\r\n\t\t:logo=\"logo\"\r\n\t\t:showTip=\"showTip\"\r\n\t\t:progress=\"value\"\r\n\t\t@abort=\"onAbort\"\r\n\t\t@close=\"onCloseH5\"\r\n\t\t></h5-file>\r\n\t\t<!-- #endif -->\r\n\t</view>\r\n</template>\n\n<script>\r\nimport h5File from './h5-file.vue';\r\nexport default {\r\n\tcomponents: {h5File},\r\n\tprops: {\r\n\t\tlogo: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fbpic.588ku.com%2Felement_origin_min_pic%2F00%2F00%2F07%2F155788a6d8a5c42.jpg&refer=http%3A%2F%2Fbpic.588ku.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1619847627&t=2da40b583002205c204d980b54b35040'\r\n\t\t},\r\n\t\ttop: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'auto'\r\n\t\t},\r\n\t\tbgColor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'rgba(49, 126, 243, 0.5)',\r\n\t\t},\r\n\t\tcolor: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '#e54d42',\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\tthis.uploadTask = null;\r\n\t\treturn {\r\n\t\t\tcubgColor: '',\r\n\t\t\tloading: false,\r\n\t\t\tvalue: 5,\r\n\t\t\tshow: false,\r\n\t\t\tmsg: '执行完毕~',\r\n\t\t\tshowH5: false,\r\n\t\t\tshowTip: false,\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\ttoast(title = '',{ duration = 2000, icon = 'none'} = {}) {\r\n\t\t\tuni.showToast({title,duration,icon});\r\n\t\t},\r\n\t\tgetRequest(url) {  \r\n\t\t\t\r\n\t\t\tlet theRequest = new Object(); \r\n\t\t\tlet index = url.indexOf(\"?\");\r\n\t\t\tif (index != -1) {  \r\n\t\t\t\tlet str = url.substring(index+1);  \r\n\t\t\t\tlet strs = str.split(\"&\");  \r\n\t\t\t\tfor(let i = 0; i < strs.length; i ++) {  \r\n\t\t\t\t\ttheRequest[strs[i].split(\"=\")[0]]=unescape(strs[i].split(\"=\")[1]);  \r\n\t\t\t\t} \r\n\t\t\t}  \r\n\t\t\treturn theRequest;  \r\n\t\t},\r\n\t\t/*\r\n\t\t\t上传说明：\r\n\t\t\tcurrentWebview: 当前窗口webview对象\r\n\t\t\turl：上传接口地址\r\n\t\t\tname：上传文件key值\r\n\t\t\theader: 上传接口请求头\r\n\t\t\t...：body内其他参数\r\n\t\t*/\r\n\t\tappChooseFile({currentWebview,url,name = 'file',header,...formData} = {}) {\r\n\t\t\t// #ifdef APP-PLUS\r\n\r\n\t\t\t\tlet wvPath = '/hybrid/html/index.html';\r\n\t\t\t\tlet wv = plus.webview.create(\"\",wvPath,{\r\n\t\t\t\t\t'uni-app': 'none',\r\n\t\t\t\t\ttop: 0,\r\n\t\t\t\t\theight: '100%',\r\n\t\t\t\t\tbackground: 'transparent'\r\n\t\t\t\t},{\r\n\t\t\t\t\turl,\r\n\t\t\t\t\theader,\r\n\t\t\t\t\tformData,\r\n\t\t\t\t\tkey: name,\r\n\t\t\t\t\tlogo: this.logo\r\n\t\t\t\t});\r\n\t\t\t\twv.loadURL(wvPath);\r\n\t\t\t\tcurrentWebview.append(wv);\r\n\t\t\t\twv.overrideUrlLoading({mode:'reject'},(e)=>{\r\n\t\t\t\t\tlet {fileName,str} = this.getRequest(e.url);\r\n\t\t\t\t\tfileName = unescape(fileName);\r\n\t\t\t\t\tstr = unescape(str);\r\n\t\t\t\t\treturn this.handleBack(fileName,str);\r\n\t\t\t\t});\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\twxChooseFile(param) {\r\n\t\t\twx.chooseMessageFile({\r\n\t\t\t\tcount: 1,\r\n\t\t\t\ttype: 'file',\r\n\t\t\t\tsuccess: ({tempFiles}) => {\r\n\t\t\t\t\tthis.setdefUI();\r\n\t\t\t\t\tthis.handleWXUpload(param,tempFiles[0]);\r\n\t\t\t\t},\r\n\t\t\t\tfail: () => this.errorHandler('文件选择失败',this.upErr)\r\n\t\t\t})\r\n\t\t},\r\n\t\th5ChooseFile(param) {\r\n\t\t\tthis.showH5 = true;\r\n\t\t\tthis.value = 0;\r\n\t\t\tthis.$nextTick(()=>{\r\n\t\t\t\tthis.$refs.h5File.hFile.onchange = (event) => {  \r\n\t\t\t\t\tthis.handleH5Upload(param, event.target.files[0]);\r\n\t\t\t\t}  \r\n\t\t\t})\r\n\t\t},\r\n\t\thandleH5Upload({url,name = 'file',header,...data} = {},tempFile) {\r\n\t\t\tlet fileName = tempFile.name;\r\n\t\t\tlet formData = new FormData();\r\n\t\t\tfor (let keys in data) {formData.append(keys, data[keys]);}\r\n\t\t\tformData.append(name, tempFile);\r\n\t\t\tthis.uploadTask = new XMLHttpRequest();\r\n\t\t\tthis.uploadTask.open(\"POST\", url, true);\r\n\t\t\tfor (let keys in header) {this.uploadTask.setRequestHeader(keys, header[keys]);}\r\n\t\t\t\r\n\t\t\tthis.uploadTask.ontimeout = () => {\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tthis.showTip = false;\r\n\t\t\t\t\treturn this.errorHandler('请求超时',this.upErr);\r\n\t\t\t\t},1000);\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tthis.uploadTask.upload.addEventListener(\"progress\",(event) => {\r\n\t\t\t\tif(event.lengthComputable){\r\n\t\t\t\t\tthis.value = Math.ceil(event.loaded * 100 / event.total);\r\n\t\t\t\t\tif (this.value > 100) {this.value=100;}\r\n\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t\t\r\n\t\t\tthis.uploadTask.onreadystatechange = (ev) => {\r\n\t\t\t\tif(this.uploadTask.readyState == 4) {\r\n\t\t\t\t\tconsole.log('status：'+this.uploadTask.status);\r\n\t\t\t\t\tif (this.uploadTask.status == 200) {\r\n\t\t\t\t\t\treturn this.handleBack(fileName,this.uploadTask.responseText);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.showTip = false;\r\n\t\t\t\t\t\tif (this.uploadTask.status == 0) {\r\n\t\t\t\t\t\t\tconsole.log('请检查请求头Content-Type与服务端是否匹配，并确认服务端已正确开启跨域');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn this.errorHandler('文件上传失败',this.upErr);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.showTip = true;\r\n\t\t\tthis.uploadTask.send(formData);\r\n\t\t},\r\n\t\thandleWXUpload({url,name = 'file',header,...formData} = {},tempFile) {\r\n\t\t\tlet opt = {url,name,formData,header,filePath:tempFile.path};\r\n\t\t\tlet fileName = tempFile.name;\r\n\t\t\topt['fail'] = (e) => {\r\n\t\t\t\tthis.showTip = false;\r\n\t\t\t\treturn this.errorHandler('文件上传失败',this.upErr)\r\n\t\t\t};\r\n\t\t\topt['success'] = (res) => {\r\n\t\t\t\tif (res.statusCode==200) {\r\n\t\t\t\t\tlet data = JSON.parse(res.data);\r\n\t\t\t\t\t//可自行添加后台返回状态验证\r\n\t\t\t\t\treturn this.onCommit(this.$emit('up-success',{fileName,data}));\r\n\t\t\t\t}\r\n\t\t\t\treturn this.errorHandler('文件上传失败',this.upErr);\r\n\t\t\t};\r\n\t\t\tthis.showTip = true;\r\n\t\t\tthis.uploadTask = uni.uploadFile(opt);\r\n\t\t\tthis.uploadTask&&this.uploadTask.onProgressUpdate(({progress = 0}) => {\r\n\t\t\t\tif (progress <= 100) {\r\n\t\t\t\t\tthis.value = progress;\r\n\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tonCloseH5() {\r\n\t\t\tthis.showH5 = false;\r\n\t\t},\r\n\t\tonAbort() {\r\n\t\t\tthis.uploadTask&&this.uploadTask.abort();\r\n\t\t\tthis.showTip = false;\r\n\t\t},\r\n\t\t// app+h5返回内容，此处按实际项目修改\r\n\t\thandleBack(fileName,str = '{}') {\r\n\t\t\tconsole.log('可根据需求自行修改emit内容，服务端返回：'+ str);\r\n\t\t\ttry{\r\n\t\t\t\tstr = JSON.parse(str);\r\n\t\t\t}catch(e){\r\n\t\t\t\tstr = {id:str};\r\n\t\t\t}\r\n\t\t\treturn this.onCommit(this.$emit('up-success',{statusCode: 200,fileName,...str}));\r\n\t\t},\r\n\t\t/* \r\n\t\t上传\r\n\t\t*/\r\n\t\tupload(param = {}) {\r\n\t\t\tif (!param.url) {this.toast('上传地址不正确');return;}\r\n\t\t\tif (this.loading) {this.toast('还有个文件玩命处理中，请稍候..');return;}\r\n\t\t\t\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\treturn this.appChooseFile(param);\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\treturn this.wxChooseFile(param);\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\t// #ifdef H5\r\n\t\t\t\tthis.h5ChooseFile(param);\r\n\t\t\t// #endif\r\n\t\t},\r\n\t\t/* \r\n\t\t打开文件 \r\n\t\t*/\r\n\t\topen(filePath) {\r\n\t\t\tlet system = uni.getSystemInfoSync().platform;\r\n\t\t\tif(system == 'ios'){filePath = encodeURI(filePath);}\r\n\t\t\tuni.openDocument({\r\n\t\t\t\tfilePath,\r\n\t\t\t\tsuccess: (res) => {console.log('打开文档成功');}\r\n\t\t\t});\r\n\t\t},\r\n\t\t/* \r\n\t\tAPP自定义保存 \r\n\t\t */\r\n\t\tplusSaveFile({url,customName='',opt}) {\r\n\t\t\tlet dtask;\r\n\t\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\t\t// 可自行修改参数\r\n\t\t\t\t// 参数api: http://www.html5plus.org/doc/zh_cn/downloader.html#plus.downloader.DownloadOptions\r\n\t\t\t\tlet downloadOptions = {\r\n\t\t\t\t\tmethod: \"GET\",\r\n\t\t\t\t\ttimeout: 120,\r\n\t\t\t\t\tretryInterval: 10\r\n\t\t\t\t};\r\n\t\t\t\tcustomName&&(downloadOptions['filename']=`_downloads/files/${customName}`);\r\n\t\t\t\tdownloadOptions = {...downloadOptions,...opt};\r\n\t\t\t\tdtask = plus.downloader.createDownload(url, downloadOptions,(d, status)=>{\r\n\t\t\t\t\t// 下载完成\r\n\t\t\t\t\tif(status == 200){ \r\n\t\t\t\t\t\tlet tempFilePath = d.filename;\r\n\t\t\t\t\t\tthis.value = 100;\r\n\t\t\t\t\t\tthis.onCommit(resolve(tempFilePath))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t this.errorHandler('下载失败',reject)\r\n\t\t\t\t\t}  \r\n\t\t\t\t\tdtask = null;\r\n\t\t\t\t});\r\n\t\t\t\tdtask.addEventListener('statechanged',({downloadedSize=0,state=0,totalSize=0}={})=>{\r\n\t\t\t\t\tif (state===3) {\r\n\t\t\t\t\t\tlet total = totalSize>0?totalSize:fileSize;\r\n\t\t\t\t\t\tlet progressVal = Math.ceil(downloadedSize / total* 100);\r\n\t\t\t\t\t\tthis.value = progressVal>100?100:progressVal;\r\n\t\t\t\t\t\tthis.$forceUpdate()\r\n\t\t\t\t\t}\r\n\t\t\t\t},false);\r\n\t\t\t\tdtask.start();\r\n\t\t\t});\r\n\t\t},\r\n\t\t/* \r\n\t\t下载\r\n\t\t type: temporary=返回临时地址，save=长期保存到本地\r\n\t\t */\r\n\t\tdownload({url,type = 'temporary',customName = '',...opt}) {\r\n\t\t\tif (this.loading) {\r\n\t\t\t\tthis.toast('还有个文件玩命处理中，请稍候..');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.setdefUI();\r\n\t\t\t\r\n\t\t\t// #ifdef APP-PLUS\r\n\t\t\tif (type == 'save') {\r\n\t\t\t\treturn this.plusSaveFile({url,customName,opt});\r\n\t\t\t}\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\treturn new Promise((resolve,reject)=>{\r\n\t\t\t\turl = encodeURI(url);\r\n\t\t\t\tlet downloadTask = uni.downloadFile({\r\n\t\t\t\t    url,\r\n\t\t\t\t    success: ({statusCode,tempFilePath}) => {\r\n\t\t\t\t        if (statusCode === 200) {\r\n\t\t\t\t\t\t\tif (type == 'save') {\r\n\t\t\t\t\t\t\t\tuni.saveFile({\r\n\t\t\t\t\t\t\t\t\ttempFilePath,\r\n\t\t\t\t\t\t\t\t\tsuccess:({savedFilePath}) => this.onCommit(resolve(savedFilePath)),\r\n\t\t\t\t\t\t\t\t\tfail: () => this.errorHandler('下载失败',reject)\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tthis.onCommit(resolve(tempFilePath))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => this.errorHandler('下载失败',reject)\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tdownloadTask.onProgressUpdate(({progress = 0}) => {\r\n\t\t\t\t\tif (progress <= 100) {\r\n\t\t\t\t\t\tthis.$nextTick(()=>{\r\n\t\t\t\t\t\t\tthis.value = progress;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tonCommit(resolve) {\r\n\t\t\tthis.msg = '执行完毕~';\r\n\t\t\tthis.loading = false;\r\n\t\t\tthis.showTip = false;\r\n\t\t\tthis.cubgColor = 'rgba(57, 181, 74, 0.5)';\r\n\t\t\tsetTimeout(()=>{this.show = false;this.showH5 = false;},1500);\r\n\t\t\treturn resolve;\r\n\t\t},\r\n\t\t\r\n\t\tsetdefUI() {\r\n\t\t\tthis.cubgColor = this.bgColor;\r\n\t\t\tthis.value = 0;\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.show = true;\r\n\t\t},\r\n\t\t\r\n\t\tupErr(errText) {\r\n\t\t\tthis.$emit('up-error',errText);\r\n\t\t},\r\n\t\t\r\n\t\terrorHandler(errText,reject) {\r\n\t\t\tthis.msg = errText;\r\n\t\t\tthis.loading = false;\r\n\t\t\tthis.cubgColor = 'rgba(229, 77, 66, 0.5)';\r\n\t\t\tsetTimeout(()=>{this.show = false;},1500);\r\n\t\t\treturn reject(errText);\r\n\t\t}\r\n\t}\r\n}\n</script>\n\n<style scoped>\r\n\t.t-toptips {\r\n\t\twidth: 100%;\r\n\t\tpadding: 18upx 30upx;\r\n\t\tbox-sizing: border-box;\r\n\t\tposition: fixed;\r\n\t\tz-index: 90;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 30upx;\r\n\t\tleft: 0;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tword-break: break-all;\r\n\t\topacity: 0;\r\n\t\ttransform: translateZ(0) translateY(-100%);\r\n\t\ttransition: all 0.3s ease-in-out;\r\n\t}\r\n\t\r\n\t.t-top-show {\r\n\t\ttransform: translateZ(0) translateY(0);\r\n\t\topacity: 1;\r\n\t}\r\n\t\r\n</style>\n","import mod from \"-!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./l-file.vue?vue&type=style&index=0&id=376a91a4&scoped=true&lang=css&\"; export default mod; export * from \"-!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./l-file.vue?vue&type=style&index=0&id=376a91a4&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1618880767439\n      var cssReload = require(\"F:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}